"0",""
"0","# Convert edge data to slope angles (assuming they represent the orientations)"
"0","lineament_angles <- atan2(na.omit(values(gy)), na.omit(values(gx))) * 180 / pi"
"0",""
"0","# Adjust angles to be in the range of 0 to 360 degrees"
"0","lineament_angles <- (lineament_angles + 360) %% 360"
"0",""
"0","# Convert angles to radians for circular statistics"
"0","lineament_angles_rad <- lineament_angles * pi / 180"
"0",""
"0","# Restrict angles to the range 0-180 and 180-360"
"0","lineament_angles[lineament_angles > 180] <- lineament_angles[lineament_angles > 180] - 180"
"0",""
"0","# Create circular data object"
"0","angles_circ <- circular(lineament_angles, units = ""degrees"")"
"0",""
"0","# Define the breaks for grouping the angles"
"0","breaks <- seq(0, 360, by = 360 / 24)"
"0",""
"0","# Use the cut function to group the angles into bins"
"0","angle_bins <- cut(lineament_angles, breaks = breaks, include.lowest = TRUE)"
"0",""
"0","# Calculate the frequency of each angle bin"
"0","angle_counts <- table(angle_bins)"
"0",""
"0","# Calculate the maximum count to use as the reference for scaling"
"0","max_count <- max(angle_counts)"
"0",""
"0","# Scale the lengths of the bars based on the frequency of each angle bin"
"0","scaled_lengths <- angle_counts / max_count"
"0",""
"0","# Plot the rose diagram with adjusted lengths"
"0","rose.diag(angles_circ, bins = 24, prop = 2, col = ""red"")"
